var debug=!0,log=function(n){debug&&console.log(n)},percentChg=function(n,e){return 0!==e?(n-e)/(n+e)*100:0};
var map,gmap=function(o){"use strict";function a(){log("gmap.init() loaded"),e.mapcanvas=o(".js-gmap"),e.mapcanvas.length?n():log("gmap.init(): no mapcanvas found")}function n(){log("gmap.load() success");var o=document.createElement("script");o.type="text/javascript",o.id="new-gmap",o.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAF1sRGF7ku7L3dKictevzxUTPWc2YF6NI&callback=gmap.build",document.body.appendChild(o)}function t(){log("gmap.build() success");var a=o.extend({},e.mapDefaults,{zoom:e.zoom,center:new google.maps.LatLng(e.latCenter,e.lonCenter),zoomControlOptions:{position:google.maps.ControlPosition.LEFT_CENTER},maxZoom:e.maxZoom,minZoom:e.minZoom,styles:[]});map=new google.maps.Map(e.mapcanvas[0],a)}var e={mapDefaults:{panControl:!1,zoomControl:!0,zoomControlOptions:!0,scaleControl:!1,mapTypeControl:!1,streetViewControl:!1,scrollwheel:!1,zoom:4,maxZoom:16,minZoom:3},mapcanvas:0,latCenter:37.09024,lonCenter:-96.712891};return{init:a,build:t}}(jQuery);
var getData=function(e){"use strict";function t(e,t,o){void 0!==t&&(t=t),void 0!==o&&(o=o),"All States"===e&&a()}function a(){e.support.cors=!0,log("get state data"),e.isEmptyObject(s)?e.ajax({url:"state_code.json",method:"GET",dataType:"json",success:function(e){o(e)},error:log("csv failed refreshed 2"),complete:function(){log("load csv completed")}}):o(s)}function o(t){if(!e.isEmptyObject(c))return log("state data already exists"),void log(c);log("get state data"),s=t;var a=[],o=[];for(var n in s){var i="https://www.quandl.com/api/v3/datasets/ZILL/S@stateCode_A.json?collapse=annual&api_key=1aGVznRZH7ckoyhVtges".replace("@stateCode",s[n]);a.push(i),o.push(n)}r(a,o,0)}function r(t,a,o){log("make sync request: "+o),o>Object.keys(s).length||setTimeout(function(){e.ajax({url:t[o],method:"GET",dataType:"json",success:function(e){log(e),o+=1,n(e,a[o])},error:log("state data failed: "+o)})},1e3)}function n(e,t){var a=e.dataset.data;c[t]={HousePriceYr1:a[0][1],HousePriceYr3:2 in a?a[2][1]:0,HousePriceYr5:4 in a?a[4][1]:0,HousePriceYr10:9 in a?a[9][1]:0,PriceChangeYr1:percentChg(a[0][1],a[1][1]),PriceChangeYr3:percentChg(a[0][1],2 in a?a[2][1]:0),PriceChangeYr5:percentChg(a[0][1],4 in a?a[4][1]:0),PriceChangeYr10:percentChg(a[0][1],9 in a?a[9][1]:0)},log(c)}var s={},c={};return{from:t}}(jQuery);
!function(t){"use strict";log("app loaded"),gmap.init(),getData.from("All States")}(jQuery);